{% block content %}
<div class="panel-sidemenu">
  <h4> Admin Panel </h4>
  <ul>
    <li>
      <a href="/panel/users"> Users 
        <div class="spinner spinner-border spinner-border-sm" role="status">
          <span class="visually-hidden"></span>
        </div>
        <span class="count" id="users-count"></span>
      </a>
    </li>
    <li>
      <a href="/panel/plays"> Plays 
        <div class="spinner spinner-border spinner-border-sm" role="status">
          <span class="visually-hidden"></span>
        </div>
        <span class="count" id="plays-count"></span>
      </a>
    </li>
  </ul>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    fetchCountsAndStopSpinners();
  });

  function fetchCountsAndStopSpinners() {
    fetch('/panel/get_counts')
      .then(response => response.json())
      .then(data => {
        const spinners = document.querySelectorAll('.spinner');
        const counts = document.querySelectorAll('.count');

        spinners.forEach((spinner, index) => {
          const count = counts[index];
          count.textContent = `(${data.counts[index]})`;

          spinner.style.display = 'none';
        });
      })
  }
</script>
{% endblock %}
